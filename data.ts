const timestreamPayload = {
  QueryId: "AEBQEANEWVP3B2CKKMXLBRWPZPKSJ6W7DYS3YDKKD74IVZUTGFAVUTC6BPANY4A",
  Rows: [
    {
      Data: [
        {
          ScalarValue: "Jhon QA",
        },
        {
          ScalarValue: "USER",
        },
        {
          ScalarValue: "HOLDING",
        },
        {
          ScalarValue: "cb67955a-b50d-4958-bd14-53c12116316d",
        },
        {
          ScalarValue: "2926c8ee-9248-4402-936e-8d1947e47275",
        },
        {
          ScalarValue: "Asset Allocation %",
        },
        {
          ScalarValue: "81a8e1b1-3056-4425-b336-769e63df1a92",
        },
        {
          ScalarValue: "1867 GATEWOOD DR.",
        },
        {
          ScalarValue: "value",
        },
        {
          ScalarValue: "2022-06-03 19:45:46.183000000",
        },
        {
          ScalarValue: "0.0",
        },
      ],
    },
    {
      Data: [
        {
          ScalarValue: "Jhon QA",
        },
        {
          ScalarValue: "USER",
        },
        {
          ScalarValue: "HOLDING",
        },
        {
          ScalarValue: "cb67955a-b50d-4958-bd14-53c12116316d",
        },
        {
          ScalarValue: "5b134b68-60f5-4c45-b259-24d7f438506c",
        },
        {
          ScalarValue: "Contributing % of Net Worth",
        },
        {
          ScalarValue: "81a8e1b1-3056-4425-b336-769e63df1a92",
        },
        {
          ScalarValue: "1867 GATEWOOD DR.",
        },
        {
          ScalarValue: "value",
        },
        {
          ScalarValue: "2022-06-03 19:45:46.154000000",
        },
        {
          ScalarValue: "0.0",
        },
      ],
    },
    {
      Data: [
        {
          ScalarValue: "Jhon QA",
        },
        {
          ScalarValue: "USER",
        },
        {
          ScalarValue: "HOLDING",
        },
        {
          ScalarValue: "cb67955a-b50d-4958-bd14-53c12116316d",
        },
        {
          ScalarValue: "43aabca9-9ac1-4169-8249-fa71165adbe4",
        },
        {
          ScalarValue: "Total Net Worth",
        },
        {
          ScalarValue: "81a8e1b1-3056-4425-b336-769e63df1a92",
        },
        {
          ScalarValue: "1867 GATEWOOD DR.",
        },
        {
          ScalarValue: "value",
        },
        {
          ScalarValue: "2022-06-03 19:45:46.098000000",
        },
        {
          ScalarValue: "48000.0",
        },
      ],
    },
    {
      Data: [
        {
          ScalarValue: "Jhon QA",
        },
        {
          ScalarValue: "USER",
        },
        {
          ScalarValue: "HOLDING",
        },
        {
          ScalarValue: "cb67955a-b50d-4958-bd14-53c12116316d",
        },
        {
          ScalarValue: "8d01e3e0-a25d-4348-aeb4-53689cda2209",
        },
        {
          ScalarValue: "Net Equity",
        },
        {
          ScalarValue: "81a8e1b1-3056-4425-b336-769e63df1a92",
        },
        {
          ScalarValue: "1867 GATEWOOD DR.",
        },
        {
          ScalarValue: "value",
        },
        {
          ScalarValue: "2022-06-03 19:45:46.098000000",
        },
        {
          ScalarValue: "48000.0",
        },
      ],
    },
    {
      Data: [
        {
          ScalarValue: "Jhon QA",
        },
        {
          ScalarValue: "USER",
        },
        {
          ScalarValue: "HOLDING",
        },
        {
          ScalarValue: "cb67955a-b50d-4958-bd14-53c12116316d",
        },
        {
          ScalarValue: "ab37cb08-11bc-45af-9e10-4d4deaeb8ed8",
        },
        {
          ScalarValue: "Asset Allocation",
        },
        {
          ScalarValue: "81a8e1b1-3056-4425-b336-769e63df1a92",
        },
        {
          ScalarValue: "1867 GATEWOOD DR.",
        },
        {
          ScalarValue: "value",
        },
        {
          ScalarValue: "2022-06-03 19:45:46.097000000",
        },
        {
          ScalarValue: "48000.0",
        },
      ],
    },
    {
      Data: [
        {
          ScalarValue: "Jhon QA",
        },
        {
          ScalarValue: "USER",
        },
        {
          ScalarValue: "HOLDING",
        },
        {
          ScalarValue: "cb67955a-b50d-4958-bd14-53c12116316d",
        },
        {
          ScalarValue: "867a8474-3e6d-405c-bbf6-feffe0f4a649",
        },
        {
          ScalarValue: "LTV",
        },
        {
          ScalarValue: "81a8e1b1-3056-4425-b336-769e63df1a92",
        },
        {
          ScalarValue: "1867 GATEWOOD DR.",
        },
        {
          ScalarValue: "value",
        },
        {
          ScalarValue: "2022-06-03 19:45:46.097000000",
        },
        {
          ScalarValue: "0.0",
        },
      ],
    },
    {
      Data: [
        {
          ScalarValue: "Jhon QA",
        },
        {
          ScalarValue: "USER",
        },
        {
          ScalarValue: "HOLDING",
        },
        {
          ScalarValue: "cb67955a-b50d-4958-bd14-53c12116316d",
        },
        {
          ScalarValue: "43aabca9-9ac1-4169-8249-fa71165adbe4",
        },
        {
          ScalarValue: "Total Net Worth",
        },
        {
          ScalarValue: "81a8e1b1-3056-4425-b336-769e63df1a92",
        },
        {
          ScalarValue: "1867 GATEWOOD DR.",
        },
        {
          ScalarValue: "value",
        },
        {
          ScalarValue: "2022-06-03 16:44:49.741000000",
        },
        {
          ScalarValue: "48000.0",
        },
      ],
    },
    {
      Data: [
        {
          ScalarValue: "Jhon QA",
        },
        {
          ScalarValue: "USER",
        },
        {
          ScalarValue: "HOLDING",
        },
        {
          ScalarValue: "cb67955a-b50d-4958-bd14-53c12116316d",
        },
        {
          ScalarValue: "8d01e3e0-a25d-4348-aeb4-53689cda2209",
        },
        {
          ScalarValue: "Net Equity",
        },
        {
          ScalarValue: "81a8e1b1-3056-4425-b336-769e63df1a92",
        },
        {
          ScalarValue: "1867 GATEWOOD DR.",
        },
        {
          ScalarValue: "value",
        },
        {
          ScalarValue: "2022-06-03 16:44:49.741000000",
        },
        {
          ScalarValue: "48000.0",
        },
      ],
    },
    {
      Data: [
        {
          ScalarValue: "Jhon QA",
        },
        {
          ScalarValue: "USER",
        },
        {
          ScalarValue: "HOLDING",
        },
        {
          ScalarValue: "cb67955a-b50d-4958-bd14-53c12116316d",
        },
        {
          ScalarValue: "ab37cb08-11bc-45af-9e10-4d4deaeb8ed8",
        },
        {
          ScalarValue: "Asset Allocation",
        },
        {
          ScalarValue: "81a8e1b1-3056-4425-b336-769e63df1a92",
        },
        {
          ScalarValue: "1867 GATEWOOD DR.",
        },
        {
          ScalarValue: "value",
        },
        {
          ScalarValue: "2022-06-03 16:44:49.740000000",
        },
        {
          ScalarValue: "48000.0",
        },
      ],
    },
    {
      Data: [
        {
          ScalarValue: "Jhon QA",
        },
        {
          ScalarValue: "USER",
        },
        {
          ScalarValue: "HOLDING",
        },
        {
          ScalarValue: "cb67955a-b50d-4958-bd14-53c12116316d",
        },
        {
          ScalarValue: "43aabca9-9ac1-4169-8249-fa71165adbe4",
        },
        {
          ScalarValue: "Total Net Worth",
        },
        {
          ScalarValue: "81a8e1b1-3056-4425-b336-769e63df1a92",
        },
        {
          ScalarValue: "1867 GATEWOOD DR.",
        },
        {
          ScalarValue: "value",
        },
        {
          ScalarValue: "2022-06-03 15:32:35.773000000",
        },
        {
          ScalarValue: "96000.0",
        },
      ],
    },
    {
      Data: [
        {
          ScalarValue: "Jhon QA",
        },
        {
          ScalarValue: "USER",
        },
        {
          ScalarValue: "HOLDING",
        },
        {
          ScalarValue: "cb67955a-b50d-4958-bd14-53c12116316d",
        },
        {
          ScalarValue: "8d01e3e0-a25d-4348-aeb4-53689cda2209",
        },
        {
          ScalarValue: "Net Equity",
        },
        {
          ScalarValue: "81a8e1b1-3056-4425-b336-769e63df1a92",
        },
        {
          ScalarValue: "1867 GATEWOOD DR.",
        },
        {
          ScalarValue: "value",
        },
        {
          ScalarValue: "2022-06-03 15:32:35.773000000",
        },
        {
          ScalarValue: "96000.0",
        },
      ],
    },
    {
      Data: [
        {
          ScalarValue: "Jhon QA",
        },
        {
          ScalarValue: "USER",
        },
        {
          ScalarValue: "HOLDING",
        },
        {
          ScalarValue: "cb67955a-b50d-4958-bd14-53c12116316d",
        },
        {
          ScalarValue: "ab37cb08-11bc-45af-9e10-4d4deaeb8ed8",
        },
        {
          ScalarValue: "Asset Allocation",
        },
        {
          ScalarValue: "81a8e1b1-3056-4425-b336-769e63df1a92",
        },
        {
          ScalarValue: "1867 GATEWOOD DR.",
        },
        {
          ScalarValue: "value",
        },
        {
          ScalarValue: "2022-06-03 15:32:35.770000000",
        },
        {
          ScalarValue: "96000.0",
        },
      ],
    },
  ],
  ColumnInfo: [
    {
      Name: "owner",
      Type: {
        ScalarType: "VARCHAR",
      },
    },
    {
      Name: "ownerType",
      Type: {
        ScalarType: "VARCHAR",
      },
    },
    {
      Name: "dimensionType",
      Type: {
        ScalarType: "VARCHAR",
      },
    },
    {
      Name: "dimensionId",
      Type: {
        ScalarType: "VARCHAR",
      },
    },
    {
      Name: "kpiId",
      Type: {
        ScalarType: "VARCHAR",
      },
    },
    {
      Name: "kpiName",
      Type: {
        ScalarType: "VARCHAR",
      },
    },
    {
      Name: "ownerId",
      Type: {
        ScalarType: "VARCHAR",
      },
    },
    {
      Name: "dimension",
      Type: {
        ScalarType: "VARCHAR",
      },
    },
    {
      Name: "measure_name",
      Type: {
        ScalarType: "VARCHAR",
      },
    },
    {
      Name: "time",
      Type: {
        ScalarType: "TIMESTAMP",
      },
    },
    {
      Name: "measure_value::double",
      Type: {
        ScalarType: "DOUBLE",
      },
    },
  ],
  QueryStatus: {
    ProgressPercentage: 100,
    CumulativeBytesScanned: 2931,
    CumulativeBytesMetered: 10000000,
  },
}
const main = async () => {
  const rows = JSONPath({ json: timestreamPayload, path: "$...ScalarValue" })
  const columns = JSONPath({ json: timestreamPayload, path: "$..Name" })
  let indexColumns = 0
  const obj = {}
  const dat = rows.map((row) => {
    obj[columns[indexColumns]] = row
    indexColumns++
    if (indexColumns === columns.length) {
      indexColumns = 0
    }
    return obj
  })
  console.log(dat)
}

main()
